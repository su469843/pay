"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/stats/route";
exports.ids = ["app/api/stats/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstats%2Froute&page=%2Fapi%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstats%2Froute&page=%2Fapi%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_thinkpad_Desktop_pay_src_app_api_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/stats/route.ts */ \"(rsc)/./src/app/api/stats/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/stats/route\",\n        pathname: \"/api/stats\",\n        filename: \"route\",\n        bundlePath: \"app/api/stats/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\thinkpad\\\\Desktop\\\\pay\\\\src\\\\app\\\\api\\\\stats\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_thinkpad_Desktop_pay_src_app_api_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/stats/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdGF0cyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc3RhdHMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzdGF0cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUN0aGlua3BhZCU1Q0Rlc2t0b3AlNUNwYXklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3RoaW5rcGFkJTVDRGVza3RvcCU1Q3BheSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNpQjtBQUM5RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3BheS1uZXh0anMvPzZiNDEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcdGhpbmtwYWRcXFxcRGVza3RvcFxcXFxwYXlcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcc3RhdHNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N0YXRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3RhdHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N0YXRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcdGhpbmtwYWRcXFxcRGVza3RvcFxcXFxwYXlcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcc3RhdHNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvc3RhdHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstats%2Froute&page=%2Fapi%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/stats/route.ts":
/*!************************************!*\
  !*** ./src/app/api/stats/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/database */ \"(rsc)/./src/lib/database.ts\");\n/* harmony import */ var _lib_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/storage */ \"(rsc)/./src/lib/storage.ts\");\n\n\n\n// 确保数据库已初始化\nlet dbInitialized = false;\nasync function ensureDbInitialized() {\n    if (!dbInitialized) {\n        await (0,_lib_database__WEBPACK_IMPORTED_MODULE_1__.initializeDatabase)();\n        dbInitialized = true;\n    }\n}\n// GET - 获取统计数据\nasync function GET(request) {\n    try {\n        await ensureDbInitialized();\n        const stats = await _lib_storage__WEBPACK_IMPORTED_MODULE_2__.StatsService.getStats();\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            data: stats\n        });\n    } catch (error) {\n        console.error(\"Error fetching stats:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Failed to fetch stats\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdGF0cy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXVEO0FBQ0o7QUFDUDtBQUU1QyxZQUFZO0FBQ1osSUFBSUcsZ0JBQWdCO0FBRXBCLGVBQWVDO0lBQ2IsSUFBSSxDQUFDRCxlQUFlO1FBQ2xCLE1BQU1GLGlFQUFrQkE7UUFDeEJFLGdCQUFnQjtJQUNsQjtBQUNGO0FBRUEsZUFBZTtBQUNSLGVBQWVFLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNRjtRQUVOLE1BQU1HLFFBQVEsTUFBTUwsc0RBQVlBLENBQUNNLFFBQVE7UUFFekMsT0FBT1Isa0ZBQVlBLENBQUNTLElBQUksQ0FBQztZQUFFQyxTQUFTO1lBQU1DLE1BQU1KO1FBQU07SUFDeEQsRUFBRSxPQUFPSyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE9BQU9aLGtGQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0UsT0FBTztRQUF3QixHQUNqRDtZQUFFRSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BheS1uZXh0anMvLi9zcmMvYXBwL2FwaS9zdGF0cy9yb3V0ZS50cz8zYjYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGluaXRpYWxpemVEYXRhYmFzZSB9IGZyb20gJ0AvbGliL2RhdGFiYXNlJ1xuaW1wb3J0IHsgU3RhdHNTZXJ2aWNlIH0gZnJvbSAnQC9saWIvc3RvcmFnZSdcblxuLy8g56Gu5L+d5pWw5o2u5bqT5bey5Yid5aeL5YyWXG5sZXQgZGJJbml0aWFsaXplZCA9IGZhbHNlXG5cbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZURiSW5pdGlhbGl6ZWQoKSB7XG4gIGlmICghZGJJbml0aWFsaXplZCkge1xuICAgIGF3YWl0IGluaXRpYWxpemVEYXRhYmFzZSgpXG4gICAgZGJJbml0aWFsaXplZCA9IHRydWVcbiAgfVxufVxuXG4vLyBHRVQgLSDojrflj5bnu5/orqHmlbDmja5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBlbnN1cmVEYkluaXRpYWxpemVkKClcbiAgICBcbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IFN0YXRzU2VydmljZS5nZXRTdGF0cygpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogc3RhdHMgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdGF0czonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBzdGF0cycgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJpbml0aWFsaXplRGF0YWJhc2UiLCJTdGF0c1NlcnZpY2UiLCJkYkluaXRpYWxpemVkIiwiZW5zdXJlRGJJbml0aWFsaXplZCIsIkdFVCIsInJlcXVlc3QiLCJzdGF0cyIsImdldFN0YXRzIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/stats/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/database.ts":
/*!*****************************!*\
  !*** ./src/lib/database.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   generateId: () => (/* binding */ generateId),\n/* harmony export */   getClient: () => (/* binding */ getClient),\n/* harmony export */   initializeDatabase: () => (/* binding */ initializeDatabase),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n\n// 检测是否为Neon数据库\nconst isNeonDatabase = process.env.PGHOST?.includes(\"neon.tech\") || process.env.DATABASE_URL?.includes(\"neon.tech\") || false;\n// 数据库配置 - 优先使用环境变量\nconst dbConfig = process.env.PGHOST ? {\n    // 使用PostgreSQL环境变量\n    host: process.env.PGHOST,\n    database: process.env.PGDATABASE,\n    user: process.env.PGUSER,\n    password: process.env.PGPASSWORD,\n    port: parseInt(process.env.PGPORT || \"5432\"),\n    // Neon数据库SSL配置\n    ssl: isNeonDatabase ? {\n        rejectUnauthorized: false\n    } : process.env.PGSSLMODE === \"require\",\n    // 针对Neon优化的连接池配置\n    max: isNeonDatabase ? 5 : 20,\n    min: 0,\n    idleTimeoutMillis: 30000,\n    connectionTimeoutMillis: 30000\n} : {\n    // 回退到连接字符串\n    connectionString: process.env.DATABASE_URL,\n    // Neon数据库SSL配置\n    ssl: isNeonDatabase ? {\n        rejectUnauthorized: false\n    } : false,\n    // 针对Neon优化的连接池配置\n    max: isNeonDatabase ? 5 : 20,\n    min: 0,\n    idleTimeoutMillis: 30000,\n    connectionTimeoutMillis: 30000\n};\n// 创建连接池\nconst pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool(dbConfig);\n// 测试数据库连接\npool.on(\"connect\", (client)=>{\n    console.log(\"✅ Connected to PostgreSQL database\");\n    const connectionInfo = process.env.PGHOST ? `Host: ${process.env.PGHOST}, Database: ${process.env.PGDATABASE}` : process.env.DATABASE_URL?.replace(/:[^:@]*@/, \":***@\") || \"Unknown\";\n    console.log(\"Connection info:\", connectionInfo);\n});\npool.on(\"error\", (err)=>{\n    console.error(\"❌ Unexpected error on idle client:\", err.message);\n    console.error(\"Error code:\", err.code);\n    console.error(\"Error details:\", err.detail || \"No additional details\");\n    console.error(\"Error hint:\", err.hint || \"No additional hints\");\n// 不要立即退出进程，让应用继续运行并重试连接\n});\npool.on(\"acquire\", ()=>{\n    console.log(\"\\uD83D\\uDD17 Client acquired from pool\");\n});\npool.on(\"release\", ()=>{\n    console.log(\"\\uD83D\\uDD13 Client released back to pool\");\n});\n// 导出查询函数\nconst query = (text, params)=>{\n    return pool.query(text, params);\n};\n// 导出事务函数\nconst getClient = ()=>{\n    return pool.connect();\n};\n// 测试数据库连接\nasync function testConnection() {\n    try {\n        console.log(\"\\uD83D\\uDD0D Testing database connection...\");\n        if (process.env.PGHOST) {\n            console.log(\"Using PG environment variables:\");\n            console.log(\"PGHOST:\", process.env.PGHOST);\n            console.log(\"PGDATABASE:\", process.env.PGDATABASE);\n            console.log(\"PGUSER:\", process.env.PGUSER);\n            console.log(\"PGSSLMODE:\", process.env.PGSSLMODE);\n        } else {\n            console.log(\"Using DATABASE_URL:\", process.env.DATABASE_URL?.replace(/:[^:@]*@/, \":***@\"));\n        }\n        const client = await pool.connect();\n        console.log(\"✅ Client connected successfully\");\n        const result = await client.query(\"SELECT 1 as test, NOW() as current_time\");\n        console.log(\"✅ Query executed successfully:\", result.rows[0]);\n        client.release();\n        console.log(\"✅ Database connection test successful\");\n        return true;\n    } catch (error) {\n        console.error(\"❌ Database connection test failed:\");\n        console.error(\"Error message:\", error.message);\n        console.error(\"Error code:\", error.code);\n        console.error(\"Error stack:\", error.stack);\n        if (error.detail) console.error(\"Error detail:\", error.detail);\n        if (error.hint) console.error(\"Error hint:\", error.hint);\n        return false;\n    }\n}\n// 重试函数\nasync function retryOperation(operation, maxRetries = 3, delay = 1000) {\n    for(let i = 0; i < maxRetries; i++){\n        try {\n            return await operation();\n        } catch (error) {\n            if (i === maxRetries - 1) throw error;\n            console.log(`Operation failed, retrying in ${delay}ms... (${i + 1}/${maxRetries})`);\n            await new Promise((resolve)=>setTimeout(resolve, delay));\n            delay *= 2 // 指数退避\n            ;\n        }\n    }\n    throw new Error(\"Max retries exceeded\");\n}\n// 初始化数据库表结构\nasync function initializeDatabase() {\n    try {\n        console.log(\"Initializing database...\");\n        // 首先测试连接\n        const isConnected = await testConnection();\n        if (!isConnected) {\n            throw new Error(\"Cannot establish database connection\");\n        }\n        // 使用重试机制创建表\n        await retryOperation(async ()=>{\n            // 创建订单表\n            await query(`\n         CREATE TABLE IF NOT EXISTS orders (\n           order_id VARCHAR(50) PRIMARY KEY,\n           payment_id VARCHAR(50) NOT NULL,\n           amount DECIMAL(10,2) NOT NULL,\n           balance DECIMAL(10,2) NOT NULL,\n           status VARCHAR(20) NOT NULL DEFAULT 'pending',\n           payment_method VARCHAR(50) DEFAULT 'pending',\n           description TEXT,\n           user_id VARCHAR(50) NOT NULL,\n           created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n           updated_at TIMESTAMP WITH TIME ZONE\n         )\n       `);\n            // 创建优惠码表\n            await query(`\n         CREATE TABLE IF NOT EXISTS discounts (\n           discount_id VARCHAR(50) PRIMARY KEY,\n           code VARCHAR(100) UNIQUE NOT NULL,\n           balance DECIMAL(10,2) NOT NULL,\n           is_full_discount BOOLEAN DEFAULT FALSE,\n           status VARCHAR(20) NOT NULL DEFAULT 'active',\n           description TEXT,\n           usage_count INTEGER DEFAULT 0,\n           max_usage INTEGER,\n           min_amount DECIMAL(10,2),\n           created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n         )\n       `);\n            // 创建支付记录表\n            await query(`\n         CREATE TABLE IF NOT EXISTS payment_records (\n           record_id VARCHAR(50) PRIMARY KEY,\n           payment_id VARCHAR(50) NOT NULL,\n           order_id VARCHAR(50) NOT NULL,\n           amount DECIMAL(10,2) NOT NULL,\n           paid_amount DECIMAL(10,2) NOT NULL,\n           discount_amount DECIMAL(10,2) NOT NULL,\n           payment_method VARCHAR(50) NOT NULL,\n           user_id VARCHAR(50) NOT NULL,\n           discount_id VARCHAR(50) NOT NULL,\n           discount_code VARCHAR(100) NOT NULL,\n           paid_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n           order_description TEXT\n         )\n       `);\n            // 创建索引\n            await query(\"CREATE INDEX IF NOT EXISTS idx_orders_user_id ON orders(user_id)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_orders_status ON orders(status)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_orders_created_at ON orders(created_at)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_discounts_code ON discounts(code)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_discounts_status ON discounts(status)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_payment_records_order_id ON payment_records(order_id)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_payment_records_user_id ON payment_records(user_id)\");\n            await query(\"CREATE INDEX IF NOT EXISTS idx_payment_records_paid_at ON payment_records(paid_at)\");\n        });\n        console.log(\"Database initialized successfully!\");\n    } catch (error) {\n        console.error(\"Error initializing database:\", error);\n        throw error;\n    }\n}\n// 生成唯一ID\nfunction generateId(prefix = \"\") {\n    return prefix + Date.now() + \"-\" + Math.random().toString(36).substr(2, 9);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLQyxNQUFNLEdBQUdDLFFBQVEsQ0FBQyxJQUFJQyxNQUFNLENBQUMsR0FBRztBQUMxRTtBQUVBLGlFQUFlekMsSUFBSUEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3BheS1uZXh0anMvLi9zcmMvbGliL2RhdGFiYXNlLnRzP2MxYjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9vbCwgUG9vbENvbmZpZyB9IGZyb20gJ3BnJ1xuXG4vLyDmo4DmtYvmmK/lkKbkuLpOZW9u5pWw5o2u5bqTXG5jb25zdCBpc05lb25EYXRhYmFzZSA9IChwcm9jZXNzLmVudi5QR0hPU1Q/LmluY2x1ZGVzKCduZW9uLnRlY2gnKSB8fCBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkw/LmluY2x1ZGVzKCduZW9uLnRlY2gnKSkgfHwgZmFsc2U7XG5cbi8vIOaVsOaNruW6k+mFjee9riAtIOS8mOWFiOS9v+eUqOeOr+Wig+WPmOmHj1xuY29uc3QgZGJDb25maWc6IFBvb2xDb25maWcgPSBwcm9jZXNzLmVudi5QR0hPU1QgPyB7XG4gIC8vIOS9v+eUqFBvc3RncmVTUUznjq/looPlj5jph49cbiAgaG9zdDogcHJvY2Vzcy5lbnYuUEdIT1NULFxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuUEdEQVRBQkFTRSxcbiAgdXNlcjogcHJvY2Vzcy5lbnYuUEdVU0VSLFxuICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUEdQQVNTV09SRCxcbiAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuUEdQT1JUIHx8ICc1NDMyJyksXG4gIC8vIE5lb27mlbDmja7lupNTU0zphY3nva5cbiAgc3NsOiBpc05lb25EYXRhYmFzZSA/IHtcbiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlXG4gIH0gOiAocHJvY2Vzcy5lbnYuUEdTU0xNT0RFID09PSAncmVxdWlyZScpLFxuICAvLyDpkojlr7lOZW9u5LyY5YyW55qE6L+e5o6l5rGg6YWN572uXG4gIG1heDogaXNOZW9uRGF0YWJhc2UgPyA1IDogMjAsXG4gIG1pbjogMCxcbiAgaWRsZVRpbWVvdXRNaWxsaXM6IDMwMDAwLFxuICBjb25uZWN0aW9uVGltZW91dE1pbGxpczogMzAwMDBcbn0gOiB7XG4gIC8vIOWbnumAgOWIsOi/nuaOpeWtl+espuS4slxuICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXG4gIC8vIE5lb27mlbDmja7lupNTU0zphY3nva5cbiAgc3NsOiBpc05lb25EYXRhYmFzZSA/IHtcbiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlXG4gIH0gOiBmYWxzZSxcbiAgLy8g6ZKI5a+5TmVvbuS8mOWMlueahOi/nuaOpeaxoOmFjee9rlxuICBtYXg6IGlzTmVvbkRhdGFiYXNlID8gNSA6IDIwLFxuICBtaW46IDAsXG4gIGlkbGVUaW1lb3V0TWlsbGlzOiAzMDAwMCxcbiAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IDMwMDAwXG59XG5cbi8vIOWIm+W7uui/nuaOpeaxoFxuY29uc3QgcG9vbCA9IG5ldyBQb29sKGRiQ29uZmlnKVxuXG4vLyDmtYvor5XmlbDmja7lupPov57mjqVcbnBvb2wub24oJ2Nvbm5lY3QnLCAoY2xpZW50KSA9PiB7XG4gIGNvbnNvbGUubG9nKCfinIUgQ29ubmVjdGVkIHRvIFBvc3RncmVTUUwgZGF0YWJhc2UnKVxuICBjb25zdCBjb25uZWN0aW9uSW5mbyA9IHByb2Nlc3MuZW52LlBHSE9TVCBcbiAgICA/IGBIb3N0OiAke3Byb2Nlc3MuZW52LlBHSE9TVH0sIERhdGFiYXNlOiAke3Byb2Nlc3MuZW52LlBHREFUQUJBU0V9YFxuICAgIDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMPy5yZXBsYWNlKC86W146QF0qQC8sICc6KioqQCcpIHx8ICdVbmtub3duJ1xuICBjb25zb2xlLmxvZygnQ29ubmVjdGlvbiBpbmZvOicsIGNvbm5lY3Rpb25JbmZvKVxufSlcblxucG9vbC5vbignZXJyb3InLCAoZXJyOiBhbnkpID0+IHtcbiAgY29uc29sZS5lcnJvcign4p2MIFVuZXhwZWN0ZWQgZXJyb3Igb24gaWRsZSBjbGllbnQ6JywgZXJyLm1lc3NhZ2UpXG4gIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvZGU6JywgZXJyLmNvZGUpXG4gIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRldGFpbHM6JywgZXJyLmRldGFpbCB8fCAnTm8gYWRkaXRpb25hbCBkZXRhaWxzJylcbiAgY29uc29sZS5lcnJvcignRXJyb3IgaGludDonLCBlcnIuaGludCB8fCAnTm8gYWRkaXRpb25hbCBoaW50cycpXG4gIC8vIOS4jeimgeeri+WNs+mAgOWHuui/m+eoi++8jOiuqeW6lOeUqOe7p+e7rei/kOihjOW5tumHjeivlei/nuaOpVxufSlcblxucG9vbC5vbignYWNxdWlyZScsICgpID0+IHtcbiAgY29uc29sZS5sb2coJ/CflJcgQ2xpZW50IGFjcXVpcmVkIGZyb20gcG9vbCcpXG59KVxuXG5wb29sLm9uKCdyZWxlYXNlJywgKCkgPT4ge1xuICBjb25zb2xlLmxvZygn8J+UkyBDbGllbnQgcmVsZWFzZWQgYmFjayB0byBwb29sJylcbn0pXG5cbi8vIOWvvOWHuuafpeivouWHveaVsFxuZXhwb3J0IGNvbnN0IHF1ZXJ5ID0gKHRleHQ6IHN0cmluZywgcGFyYW1zPzogYW55W10pID0+IHtcbiAgcmV0dXJuIHBvb2wucXVlcnkodGV4dCwgcGFyYW1zKVxufVxuXG4vLyDlr7zlh7rkuovliqHlh73mlbBcbmV4cG9ydCBjb25zdCBnZXRDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiBwb29sLmNvbm5lY3QoKVxufVxuXG4vLyDmtYvor5XmlbDmja7lupPov57mjqVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0Q29ubmVjdGlvbigpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+UjSBUZXN0aW5nIGRhdGFiYXNlIGNvbm5lY3Rpb24uLi4nKVxuICAgIGlmIChwcm9jZXNzLmVudi5QR0hPU1QpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBQRyBlbnZpcm9ubWVudCB2YXJpYWJsZXM6JylcbiAgICAgIGNvbnNvbGUubG9nKCdQR0hPU1Q6JywgcHJvY2Vzcy5lbnYuUEdIT1NUKVxuICAgICAgY29uc29sZS5sb2coJ1BHREFUQUJBU0U6JywgcHJvY2Vzcy5lbnYuUEdEQVRBQkFTRSlcbiAgICAgIGNvbnNvbGUubG9nKCdQR1VTRVI6JywgcHJvY2Vzcy5lbnYuUEdVU0VSKVxuICAgICAgY29uc29sZS5sb2coJ1BHU1NMTU9ERTonLCBwcm9jZXNzLmVudi5QR1NTTE1PREUpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBEQVRBQkFTRV9VUkw6JywgcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMPy5yZXBsYWNlKC86W146QF0qQC8sICc6KioqQCcpKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKVxuICAgIGNvbnNvbGUubG9nKCfinIUgQ2xpZW50IGNvbm5lY3RlZCBzdWNjZXNzZnVsbHknKVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeSgnU0VMRUNUIDEgYXMgdGVzdCwgTk9XKCkgYXMgY3VycmVudF90aW1lJylcbiAgICBjb25zb2xlLmxvZygn4pyFIFF1ZXJ5IGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseTonLCByZXN1bHQucm93c1swXSlcbiAgICBcbiAgICBjbGllbnQucmVsZWFzZSgpXG4gICAgY29uc29sZS5sb2coJ+KchSBEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCcpXG4gICAgcmV0dXJuIHRydWVcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3QgZmFpbGVkOicpXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWVzc2FnZTonLCBlcnJvci5tZXNzYWdlKVxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvZGU6JywgZXJyb3IuY29kZSlcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdGFjazonLCBlcnJvci5zdGFjaylcbiAgICBpZiAoZXJyb3IuZGV0YWlsKSBjb25zb2xlLmVycm9yKCdFcnJvciBkZXRhaWw6JywgZXJyb3IuZGV0YWlsKVxuICAgIGlmIChlcnJvci5oaW50KSBjb25zb2xlLmVycm9yKCdFcnJvciBoaW50OicsIGVycm9yLmhpbnQpXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuLy8g6YeN6K+V5Ye95pWwXG5hc3luYyBmdW5jdGlvbiByZXRyeU9wZXJhdGlvbjxUPihvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sIG1heFJldHJpZXMgPSAzLCBkZWxheSA9IDEwMDApOiBQcm9taXNlPFQ+IHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhSZXRyaWVzOyBpKyspIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IG9wZXJhdGlvbigpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChpID09PSBtYXhSZXRyaWVzIC0gMSkgdGhyb3cgZXJyb3JcbiAgICAgIGNvbnNvbGUubG9nKGBPcGVyYXRpb24gZmFpbGVkLCByZXRyeWluZyBpbiAke2RlbGF5fW1zLi4uICgke2kgKyAxfS8ke21heFJldHJpZXN9KWApXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKVxuICAgICAgZGVsYXkgKj0gMiAvLyDmjIfmlbDpgIDpgb9cbiAgICB9XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKCdNYXggcmV0cmllcyBleGNlZWRlZCcpXG59XG5cbi8vIOWIneWni+WMluaVsOaNruW6k+ihqOe7k+aehFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVEYXRhYmFzZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnSW5pdGlhbGl6aW5nIGRhdGFiYXNlLi4uJylcbiAgICBcbiAgICAvLyDpppblhYjmtYvor5Xov57mjqVcbiAgICBjb25zdCBpc0Nvbm5lY3RlZCA9IGF3YWl0IHRlc3RDb25uZWN0aW9uKClcbiAgICBpZiAoIWlzQ29ubmVjdGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBlc3RhYmxpc2ggZGF0YWJhc2UgY29ubmVjdGlvbicpXG4gICAgfVxuICAgIFxuICAgIC8vIOS9v+eUqOmHjeivleacuuWItuWIm+W7uuihqFxuICAgICBhd2FpdCByZXRyeU9wZXJhdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgLy8g5Yib5bu66K6i5Y2V6KGoXG4gICAgICAgYXdhaXQgcXVlcnkoYFxuICAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgb3JkZXJzIChcbiAgICAgICAgICAgb3JkZXJfaWQgVkFSQ0hBUig1MCkgUFJJTUFSWSBLRVksXG4gICAgICAgICAgIHBheW1lbnRfaWQgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgICAgIGFtb3VudCBERUNJTUFMKDEwLDIpIE5PVCBOVUxMLFxuICAgICAgICAgICBiYWxhbmNlIERFQ0lNQUwoMTAsMikgTk9UIE5VTEwsXG4gICAgICAgICAgIHN0YXR1cyBWQVJDSEFSKDIwKSBOT1QgTlVMTCBERUZBVUxUICdwZW5kaW5nJyxcbiAgICAgICAgICAgcGF5bWVudF9tZXRob2QgVkFSQ0hBUig1MCkgREVGQVVMVCAncGVuZGluZycsXG4gICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQsXG4gICAgICAgICAgIHVzZXJfaWQgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgICAgIHVwZGF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FXG4gICAgICAgICApXG4gICAgICAgYClcbiAgICAgICBcbiAgICAgICAvLyDliJvlu7rkvJjmg6DnoIHooahcbiAgICAgICBhd2FpdCBxdWVyeShgXG4gICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBkaXNjb3VudHMgKFxuICAgICAgICAgICBkaXNjb3VudF9pZCBWQVJDSEFSKDUwKSBQUklNQVJZIEtFWSxcbiAgICAgICAgICAgY29kZSBWQVJDSEFSKDEwMCkgVU5JUVVFIE5PVCBOVUxMLFxuICAgICAgICAgICBiYWxhbmNlIERFQ0lNQUwoMTAsMikgTk9UIE5VTEwsXG4gICAgICAgICAgIGlzX2Z1bGxfZGlzY291bnQgQk9PTEVBTiBERUZBVUxUIEZBTFNFLFxuICAgICAgICAgICBzdGF0dXMgVkFSQ0hBUigyMCkgTk9UIE5VTEwgREVGQVVMVCAnYWN0aXZlJyxcbiAgICAgICAgICAgZGVzY3JpcHRpb24gVEVYVCxcbiAgICAgICAgICAgdXNhZ2VfY291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgIG1heF91c2FnZSBJTlRFR0VSLFxuICAgICAgICAgICBtaW5fYW1vdW50IERFQ0lNQUwoMTAsMiksXG4gICAgICAgICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVBcbiAgICAgICAgIClcbiAgICAgICBgKVxuICAgICAgIFxuICAgICAgIC8vIOWIm+W7uuaUr+S7mOiusOW9leihqFxuICAgICAgIGF3YWl0IHF1ZXJ5KGBcbiAgICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHBheW1lbnRfcmVjb3JkcyAoXG4gICAgICAgICAgIHJlY29yZF9pZCBWQVJDSEFSKDUwKSBQUklNQVJZIEtFWSxcbiAgICAgICAgICAgcGF5bWVudF9pZCBWQVJDSEFSKDUwKSBOT1QgTlVMTCxcbiAgICAgICAgICAgb3JkZXJfaWQgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgICAgIGFtb3VudCBERUNJTUFMKDEwLDIpIE5PVCBOVUxMLFxuICAgICAgICAgICBwYWlkX2Ftb3VudCBERUNJTUFMKDEwLDIpIE5PVCBOVUxMLFxuICAgICAgICAgICBkaXNjb3VudF9hbW91bnQgREVDSU1BTCgxMCwyKSBOT1QgTlVMTCxcbiAgICAgICAgICAgcGF5bWVudF9tZXRob2QgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgICAgIHVzZXJfaWQgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgICAgIGRpc2NvdW50X2lkIFZBUkNIQVIoNTApIE5PVCBOVUxMLFxuICAgICAgICAgICBkaXNjb3VudF9jb2RlIFZBUkNIQVIoMTAwKSBOT1QgTlVMTCxcbiAgICAgICAgICAgcGFpZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgICAgb3JkZXJfZGVzY3JpcHRpb24gVEVYVFxuICAgICAgICAgKVxuICAgICAgIGApXG4gICAgICAgXG4gICAgICAgLy8g5Yib5bu657Si5byVXG4gICAgICAgYXdhaXQgcXVlcnkoJ0NSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9vcmRlcnNfdXNlcl9pZCBPTiBvcmRlcnModXNlcl9pZCknKVxuICAgICAgIGF3YWl0IHF1ZXJ5KCdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfb3JkZXJzX3N0YXR1cyBPTiBvcmRlcnMoc3RhdHVzKScpXG4gICAgICAgYXdhaXQgcXVlcnkoJ0NSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9vcmRlcnNfY3JlYXRlZF9hdCBPTiBvcmRlcnMoY3JlYXRlZF9hdCknKVxuICAgICAgIGF3YWl0IHF1ZXJ5KCdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfZGlzY291bnRzX2NvZGUgT04gZGlzY291bnRzKGNvZGUpJylcbiAgICAgICBhd2FpdCBxdWVyeSgnQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X2Rpc2NvdW50c19zdGF0dXMgT04gZGlzY291bnRzKHN0YXR1cyknKVxuICAgICAgIGF3YWl0IHF1ZXJ5KCdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfcGF5bWVudF9yZWNvcmRzX29yZGVyX2lkIE9OIHBheW1lbnRfcmVjb3JkcyhvcmRlcl9pZCknKVxuICAgICAgIGF3YWl0IHF1ZXJ5KCdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfcGF5bWVudF9yZWNvcmRzX3VzZXJfaWQgT04gcGF5bWVudF9yZWNvcmRzKHVzZXJfaWQpJylcbiAgICAgICBhd2FpdCBxdWVyeSgnQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3BheW1lbnRfcmVjb3Jkc19wYWlkX2F0IE9OIHBheW1lbnRfcmVjb3JkcyhwYWlkX2F0KScpXG4gICAgIH0pXG4gICAgXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSEnKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBkYXRhYmFzZTonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIOeUn+aIkOWUr+S4gElEXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVJZChwcmVmaXggPSAnJyk6IHN0cmluZyB7XG4gIHJldHVybiBwcmVmaXggKyBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpXG59XG5cbmV4cG9ydCBkZWZhdWx0IHBvb2wiXSwibmFtZXMiOlsiUG9vbCIsImlzTmVvbkRhdGFiYXNlIiwicHJvY2VzcyIsImVudiIsIlBHSE9TVCIsImluY2x1ZGVzIiwiREFUQUJBU0VfVVJMIiwiZGJDb25maWciLCJob3N0IiwiZGF0YWJhc2UiLCJQR0RBVEFCQVNFIiwidXNlciIsIlBHVVNFUiIsInBhc3N3b3JkIiwiUEdQQVNTV09SRCIsInBvcnQiLCJwYXJzZUludCIsIlBHUE9SVCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsIlBHU1NMTU9ERSIsIm1heCIsIm1pbiIsImlkbGVUaW1lb3V0TWlsbGlzIiwiY29ubmVjdGlvblRpbWVvdXRNaWxsaXMiLCJjb25uZWN0aW9uU3RyaW5nIiwicG9vbCIsIm9uIiwiY2xpZW50IiwiY29uc29sZSIsImxvZyIsImNvbm5lY3Rpb25JbmZvIiwicmVwbGFjZSIsImVyciIsImVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJkZXRhaWwiLCJoaW50IiwicXVlcnkiLCJ0ZXh0IiwicGFyYW1zIiwiZ2V0Q2xpZW50IiwiY29ubmVjdCIsInRlc3RDb25uZWN0aW9uIiwicmVzdWx0Iiwicm93cyIsInJlbGVhc2UiLCJzdGFjayIsInJldHJ5T3BlcmF0aW9uIiwib3BlcmF0aW9uIiwibWF4UmV0cmllcyIsImRlbGF5IiwiaSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIkVycm9yIiwiaW5pdGlhbGl6ZURhdGFiYXNlIiwiaXNDb25uZWN0ZWQiLCJnZW5lcmF0ZUlkIiwicHJlZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/database.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/storage.ts":
/*!****************************!*\
  !*** ./src/lib/storage.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DiscountService: () => (/* binding */ DiscountService),\n/* harmony export */   OrderService: () => (/* binding */ OrderService),\n/* harmony export */   PaymentRecordService: () => (/* binding */ PaymentRecordService),\n/* harmony export */   StatsService: () => (/* binding */ StatsService),\n/* harmony export */   translateStatus: () => (/* binding */ translateStatus)\n/* harmony export */ });\n/* harmony import */ var _database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./database */ \"(rsc)/./src/lib/database.ts\");\n\n// 订单相关操作\nclass OrderService {\n    // 创建订单\n    static async createOrder(orderData) {\n        const orderId = (0,_database__WEBPACK_IMPORTED_MODULE_0__.generateId)(\"order_\");\n        const createdAt = new Date();\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(`INSERT INTO orders (order_id, payment_id, amount, balance, status, payment_method, description, user_id, created_at)\n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)\n       RETURNING *`, [\n            orderId,\n            orderData.paymentId,\n            orderData.amount,\n            orderData.balance,\n            orderData.status,\n            orderData.paymentMethod,\n            orderData.description,\n            orderData.userId,\n            createdAt\n        ]);\n        return this.mapRowToOrder(result.rows[0]);\n    }\n    // 获取订单\n    static async getOrder(orderId) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM orders WHERE order_id = $1\", [\n            orderId\n        ]);\n        return result.rows.length > 0 ? this.mapRowToOrder(result.rows[0]) : null;\n    }\n    // 更新订单\n    static async updateOrder(orderId, updates) {\n        const updatedAt = new Date();\n        const setClause = [];\n        const values = [];\n        let paramIndex = 1;\n        Object.entries(updates).forEach(([key, value])=>{\n            if (key !== \"orderId\" && key !== \"createdAt\" && value !== undefined) {\n                const dbKey = this.camelToSnake(key);\n                setClause.push(`${dbKey} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        });\n        if (setClause.length === 0) return null;\n        setClause.push(`updated_at = $${paramIndex}`);\n        values.push(updatedAt);\n        values.push(orderId);\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(`UPDATE orders SET ${setClause.join(\", \")} WHERE order_id = $${paramIndex + 1} RETURNING *`, values);\n        return result.rows.length > 0 ? this.mapRowToOrder(result.rows[0]) : null;\n    }\n    // 获取用户订单列表\n    static async getUserOrders(userId, limit = 10) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM orders WHERE user_id = $1 ORDER BY created_at DESC LIMIT $2\", [\n            userId,\n            limit\n        ]);\n        return result.rows.map((row)=>this.mapRowToOrder(row));\n    }\n    // 获取所有订单\n    static async getAllOrders(limit = 50) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM orders ORDER BY created_at DESC LIMIT $1\", [\n            limit\n        ]);\n        return result.rows.map((row)=>this.mapRowToOrder(row));\n    }\n    static mapRowToOrder(row) {\n        return {\n            orderId: row.order_id,\n            paymentId: row.payment_id,\n            amount: parseFloat(row.amount),\n            balance: parseFloat(row.balance),\n            status: row.status,\n            paymentMethod: row.payment_method,\n            description: row.description,\n            userId: row.user_id,\n            createdAt: new Date(row.created_at),\n            updatedAt: row.updated_at ? new Date(row.updated_at) : undefined\n        };\n    }\n    static camelToSnake(str) {\n        return str.replace(/[A-Z]/g, (letter)=>`_${letter.toLowerCase()}`);\n    }\n}\n// 优惠码相关操作\nclass DiscountService {\n    // 创建优惠码\n    static async createDiscount(discountData) {\n        const discountId = (0,_database__WEBPACK_IMPORTED_MODULE_0__.generateId)(\"discount_\");\n        const createdAt = new Date();\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(`INSERT INTO discounts (discount_id, code, balance, is_full_discount, status, description, usage_count, max_usage, min_amount, created_at)\n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\n       RETURNING *`, [\n            discountId,\n            discountData.code,\n            discountData.balance,\n            discountData.isFullDiscount,\n            discountData.status,\n            discountData.description,\n            0,\n            discountData.maxUsage,\n            discountData.minAmount,\n            createdAt\n        ]);\n        return this.mapRowToDiscount(result.rows[0]);\n    }\n    // 根据代码获取优惠码\n    static async getDiscountByCode(code) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM discounts WHERE code = $1\", [\n            code\n        ]);\n        return result.rows.length > 0 ? this.mapRowToDiscount(result.rows[0]) : null;\n    }\n    // 验证优惠码\n    static async validateDiscount(code, orderAmount) {\n        const discount = await this.getDiscountByCode(code);\n        if (!discount) {\n            return {\n                valid: false,\n                message: \"优惠码不存在\"\n            };\n        }\n        if (discount.status !== \"active\") {\n            return {\n                valid: false,\n                message: \"优惠码已失效\"\n            };\n        }\n        if (discount.maxUsage && discount.usageCount >= discount.maxUsage) {\n            return {\n                valid: false,\n                message: \"优惠码使用次数已达上限\"\n            };\n        }\n        if (discount.minAmount && orderAmount < discount.minAmount) {\n            return {\n                valid: false,\n                message: `订单金额需满${discount.minAmount}元`\n            };\n        }\n        return {\n            valid: true,\n            discount\n        };\n    }\n    // 使用优惠码\n    static async useDiscount(discountId) {\n        await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"UPDATE discounts SET usage_count = usage_count + 1 WHERE discount_id = $1\", [\n            discountId\n        ]);\n    }\n    // 获取所有优惠码\n    static async getAllDiscounts(limit = 50) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM discounts ORDER BY created_at DESC LIMIT $1\", [\n            limit\n        ]);\n        return result.rows.map((row)=>this.mapRowToDiscount(row));\n    }\n    static mapRowToDiscount(row) {\n        return {\n            discountId: row.discount_id,\n            code: row.code,\n            balance: parseFloat(row.balance),\n            isFullDiscount: row.is_full_discount,\n            status: row.status,\n            description: row.description,\n            usageCount: row.usage_count,\n            maxUsage: row.max_usage,\n            minAmount: row.min_amount ? parseFloat(row.min_amount) : undefined,\n            createdAt: new Date(row.created_at)\n        };\n    }\n}\n// 支付记录相关操作\nclass PaymentRecordService {\n    // 创建支付记录\n    static async createPaymentRecord(recordData) {\n        const recordId = (0,_database__WEBPACK_IMPORTED_MODULE_0__.generateId)(\"payment_\");\n        const paidAt = new Date();\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(`INSERT INTO payment_records (record_id, payment_id, order_id, amount, paid_amount, discount_amount, payment_method, user_id, discount_id, discount_code, paid_at, order_description)\n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n       RETURNING *`, [\n            recordId,\n            recordData.paymentId,\n            recordData.orderId,\n            recordData.amount,\n            recordData.paidAmount,\n            recordData.discountAmount,\n            recordData.paymentMethod,\n            recordData.userId,\n            recordData.discountId,\n            recordData.discountCode,\n            paidAt,\n            recordData.orderDescription\n        ]);\n        return this.mapRowToPaymentRecord(result.rows[0]);\n    }\n    // 获取订单的支付记录\n    static async getPaymentRecordsByOrder(orderId) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM payment_records WHERE order_id = $1 ORDER BY paid_at DESC\", [\n            orderId\n        ]);\n        return result.rows.map((row)=>this.mapRowToPaymentRecord(row));\n    }\n    // 获取用户的支付记录\n    static async getUserPaymentRecords(userId, limit = 20) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM payment_records WHERE user_id = $1 ORDER BY paid_at DESC LIMIT $2\", [\n            userId,\n            limit\n        ]);\n        return result.rows.map((row)=>this.mapRowToPaymentRecord(row));\n    }\n    // 获取所有支付记录\n    static async getAllPaymentRecords(limit = 100) {\n        const result = await (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT * FROM payment_records ORDER BY paid_at DESC LIMIT $1\", [\n            limit\n        ]);\n        return result.rows.map((row)=>this.mapRowToPaymentRecord(row));\n    }\n    static mapRowToPaymentRecord(row) {\n        return {\n            recordId: row.record_id,\n            paymentId: row.payment_id,\n            orderId: row.order_id,\n            amount: parseFloat(row.amount),\n            paidAmount: parseFloat(row.paid_amount),\n            discountAmount: parseFloat(row.discount_amount),\n            paymentMethod: row.payment_method,\n            userId: row.user_id,\n            discountId: row.discount_id,\n            discountCode: row.discount_code,\n            paidAt: new Date(row.paid_at),\n            orderDescription: row.order_description\n        };\n    }\n}\n// 统计相关操作\nclass StatsService {\n    // 获取统计数据\n    static async getStats() {\n        const [ordersResult, revenueResult, discountsResult, paymentsResult] = await Promise.all([\n            (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT COUNT(*) as count FROM orders\"),\n            (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT SUM(paid_amount) as total FROM payment_records\"),\n            (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT COUNT(*) as count FROM discounts\"),\n            (0,_database__WEBPACK_IMPORTED_MODULE_0__.query)(\"SELECT COUNT(*) as count FROM payment_records\")\n        ]);\n        return {\n            totalOrders: parseInt(ordersResult.rows[0].count),\n            totalRevenue: parseFloat(revenueResult.rows[0].total || \"0\"),\n            totalDiscounts: parseInt(discountsResult.rows[0].count),\n            totalPayments: parseInt(paymentsResult.rows[0].count)\n        };\n    }\n}\n// 状态翻译\nfunction translateStatus(status) {\n    const statusMap = {\n        pending: \"待支付\",\n        paid: \"已支付\",\n        cancelled: \"已取消\",\n        active: \"有效\",\n        used: \"已使用\",\n        expired: \"已过期\"\n    };\n    return statusMap[status] || status;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUI7UUFDekM7SUFDRjtBQUNGO0FBRUEsU0FBUztBQUNGLE1BQU1DO0lBQ1gsU0FBUztJQUNULGFBQWFDLFdBS1Y7UUFDRCxNQUFNLENBQUNDLGNBQWNDLGVBQWVDLGlCQUFpQkMsZUFBZSxHQUFHLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQztZQUN2RnJHLGdEQUFLQSxDQUFDO1lBQ05BLGdEQUFLQSxDQUFDO1lBQ05BLGdEQUFLQSxDQUFDO1lBQ05BLGdEQUFLQSxDQUFDO1NBQ1A7UUFFRCxPQUFPO1lBQ0xzRyxhQUFhQyxTQUFTUCxhQUFhL0UsSUFBSSxDQUFDLEVBQUUsQ0FBQ3VGLEtBQUs7WUFDaERDLGNBQWM5RCxXQUFXc0QsY0FBY2hGLElBQUksQ0FBQyxFQUFFLENBQUN5RixLQUFLLElBQUk7WUFDeERDLGdCQUFnQkosU0FBU0wsZ0JBQWdCakYsSUFBSSxDQUFDLEVBQUUsQ0FBQ3VGLEtBQUs7WUFDdERJLGVBQWVMLFNBQVNKLGVBQWVsRixJQUFJLENBQUMsRUFBRSxDQUFDdUYsS0FBSztRQUN0RDtJQUNGO0FBQ0Y7QUFFQSxPQUFPO0FBQ0EsU0FBU0ssZ0JBQWdCakcsTUFBYztJQUM1QyxNQUFNa0csWUFBb0M7UUFDeENDLFNBQVM7UUFDVEMsTUFBTTtRQUNOQyxXQUFXO1FBQ1hDLFFBQVE7UUFDUkMsTUFBTTtRQUNOQyxTQUFTO0lBQ1g7SUFDQSxPQUFPTixTQUFTLENBQUNsRyxPQUFPLElBQUlBO0FBQzlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGF5LW5leHRqcy8uL3NyYy9saWIvc3RvcmFnZS50cz9hZmU4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHF1ZXJ5LCBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9kYXRhYmFzZSdcblxuLy8g5pWw5o2u57G75Z6L5a6a5LmJXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyIHtcbiAgb3JkZXJJZDogc3RyaW5nXG4gIHBheW1lbnRJZDogc3RyaW5nXG4gIGFtb3VudDogbnVtYmVyXG4gIGJhbGFuY2U6IG51bWJlclxuICBzdGF0dXM6ICdwZW5kaW5nJyB8ICdwYWlkJyB8ICdjYW5jZWxsZWQnXG4gIHBheW1lbnRNZXRob2Q6IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICB1c2VySWQ6IHN0cmluZ1xuICBjcmVhdGVkQXQ6IERhdGVcbiAgdXBkYXRlZEF0PzogRGF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIERpc2NvdW50IHtcbiAgZGlzY291bnRJZDogc3RyaW5nXG4gIGNvZGU6IHN0cmluZ1xuICBiYWxhbmNlOiBudW1iZXJcbiAgaXNGdWxsRGlzY291bnQ6IGJvb2xlYW5cbiAgc3RhdHVzOiAnYWN0aXZlJyB8ICd1c2VkJyB8ICdleHBpcmVkJ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICB1c2FnZUNvdW50OiBudW1iZXJcbiAgbWF4VXNhZ2U/OiBudW1iZXJcbiAgbWluQW1vdW50PzogbnVtYmVyXG4gIGNyZWF0ZWRBdDogRGF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBheW1lbnRSZWNvcmQge1xuICByZWNvcmRJZDogc3RyaW5nXG4gIHBheW1lbnRJZDogc3RyaW5nXG4gIG9yZGVySWQ6IHN0cmluZ1xuICBhbW91bnQ6IG51bWJlclxuICBwYWlkQW1vdW50OiBudW1iZXJcbiAgZGlzY291bnRBbW91bnQ6IG51bWJlclxuICBwYXltZW50TWV0aG9kOiBzdHJpbmdcbiAgdXNlcklkOiBzdHJpbmdcbiAgZGlzY291bnRJZDogc3RyaW5nXG4gIGRpc2NvdW50Q29kZTogc3RyaW5nXG4gIHBhaWRBdDogRGF0ZVxuICBvcmRlckRlc2NyaXB0aW9uPzogc3RyaW5nXG59XG5cbi8vIOiuouWNleebuOWFs+aTjeS9nFxuZXhwb3J0IGNsYXNzIE9yZGVyU2VydmljZSB7XG4gIC8vIOWIm+W7uuiuouWNlVxuICBzdGF0aWMgYXN5bmMgY3JlYXRlT3JkZXIob3JkZXJEYXRhOiBPbWl0PE9yZGVyLCAnb3JkZXJJZCcgfCAnY3JlYXRlZEF0Jz4pOiBQcm9taXNlPE9yZGVyPiB7XG4gICAgY29uc3Qgb3JkZXJJZCA9IGdlbmVyYXRlSWQoJ29yZGVyXycpXG4gICAgY29uc3QgY3JlYXRlZEF0ID0gbmV3IERhdGUoKVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgYElOU0VSVCBJTlRPIG9yZGVycyAob3JkZXJfaWQsIHBheW1lbnRfaWQsIGFtb3VudCwgYmFsYW5jZSwgc3RhdHVzLCBwYXltZW50X21ldGhvZCwgZGVzY3JpcHRpb24sIHVzZXJfaWQsIGNyZWF0ZWRfYXQpXG4gICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCAkNywgJDgsICQ5KVxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFtvcmRlcklkLCBvcmRlckRhdGEucGF5bWVudElkLCBvcmRlckRhdGEuYW1vdW50LCBvcmRlckRhdGEuYmFsYW5jZSwgb3JkZXJEYXRhLnN0YXR1cywgXG4gICAgICAgb3JkZXJEYXRhLnBheW1lbnRNZXRob2QsIG9yZGVyRGF0YS5kZXNjcmlwdGlvbiwgb3JkZXJEYXRhLnVzZXJJZCwgY3JlYXRlZEF0XVxuICAgIClcbiAgICBcbiAgICByZXR1cm4gdGhpcy5tYXBSb3dUb09yZGVyKHJlc3VsdC5yb3dzWzBdKVxuICB9XG4gIFxuICAvLyDojrflj5borqLljZVcbiAgc3RhdGljIGFzeW5jIGdldE9yZGVyKG9yZGVySWQ6IHN0cmluZyk6IFByb21pc2U8T3JkZXIgfCBudWxsPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoJ1NFTEVDVCAqIEZST00gb3JkZXJzIFdIRVJFIG9yZGVyX2lkID0gJDEnLCBbb3JkZXJJZF0pXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLmxlbmd0aCA+IDAgPyB0aGlzLm1hcFJvd1RvT3JkZXIocmVzdWx0LnJvd3NbMF0pIDogbnVsbFxuICB9XG4gIFxuICAvLyDmm7TmlrDorqLljZVcbiAgc3RhdGljIGFzeW5jIHVwZGF0ZU9yZGVyKG9yZGVySWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxPcmRlcj4pOiBQcm9taXNlPE9yZGVyIHwgbnVsbD4ge1xuICAgIGNvbnN0IHVwZGF0ZWRBdCA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBzZXRDbGF1c2UgPSBbXVxuICAgIGNvbnN0IHZhbHVlcyA9IFtdXG4gICAgbGV0IHBhcmFtSW5kZXggPSAxXG4gICAgXG4gICAgT2JqZWN0LmVudHJpZXModXBkYXRlcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAoa2V5ICE9PSAnb3JkZXJJZCcgJiYga2V5ICE9PSAnY3JlYXRlZEF0JyAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGRiS2V5ID0gdGhpcy5jYW1lbFRvU25ha2Uoa2V5KVxuICAgICAgICBzZXRDbGF1c2UucHVzaChgJHtkYktleX0gPSAkJHtwYXJhbUluZGV4fWApXG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKVxuICAgICAgICBwYXJhbUluZGV4KytcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIGlmIChzZXRDbGF1c2UubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbFxuICAgIFxuICAgIHNldENsYXVzZS5wdXNoKGB1cGRhdGVkX2F0ID0gJCR7cGFyYW1JbmRleH1gKVxuICAgIHZhbHVlcy5wdXNoKHVwZGF0ZWRBdClcbiAgICB2YWx1ZXMucHVzaChvcmRlcklkKVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgYFVQREFURSBvcmRlcnMgU0VUICR7c2V0Q2xhdXNlLmpvaW4oJywgJyl9IFdIRVJFIG9yZGVyX2lkID0gJCR7cGFyYW1JbmRleCArIDF9IFJFVFVSTklORyAqYCxcbiAgICAgIHZhbHVlc1xuICAgIClcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0LnJvd3MubGVuZ3RoID4gMCA/IHRoaXMubWFwUm93VG9PcmRlcihyZXN1bHQucm93c1swXSkgOiBudWxsXG4gIH1cbiAgXG4gIC8vIOiOt+WPlueUqOaIt+iuouWNleWIl+ihqFxuICBzdGF0aWMgYXN5bmMgZ2V0VXNlck9yZGVycyh1c2VySWQ6IHN0cmluZywgbGltaXQgPSAxMCk6IFByb21pc2U8T3JkZXJbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gb3JkZXJzIFdIRVJFIHVzZXJfaWQgPSAkMSBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0MgTElNSVQgJDInLFxuICAgICAgW3VzZXJJZCwgbGltaXRdXG4gICAgKVxuICAgIHJldHVybiByZXN1bHQucm93cy5tYXAocm93ID0+IHRoaXMubWFwUm93VG9PcmRlcihyb3cpKVxuICB9XG4gIFxuICAvLyDojrflj5bmiYDmnInorqLljZVcbiAgc3RhdGljIGFzeW5jIGdldEFsbE9yZGVycyhsaW1pdCA9IDUwKTogUHJvbWlzZTxPcmRlcltdPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBvcmRlcnMgT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDIExJTUlUICQxJyxcbiAgICAgIFtsaW1pdF1cbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLm1hcChyb3cgPT4gdGhpcy5tYXBSb3dUb09yZGVyKHJvdykpXG4gIH1cbiAgXG4gIHByaXZhdGUgc3RhdGljIG1hcFJvd1RvT3JkZXIocm93OiBhbnkpOiBPcmRlciB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9yZGVySWQ6IHJvdy5vcmRlcl9pZCxcbiAgICAgIHBheW1lbnRJZDogcm93LnBheW1lbnRfaWQsXG4gICAgICBhbW91bnQ6IHBhcnNlRmxvYXQocm93LmFtb3VudCksXG4gICAgICBiYWxhbmNlOiBwYXJzZUZsb2F0KHJvdy5iYWxhbmNlKSxcbiAgICAgIHN0YXR1czogcm93LnN0YXR1cyxcbiAgICAgIHBheW1lbnRNZXRob2Q6IHJvdy5wYXltZW50X21ldGhvZCxcbiAgICAgIGRlc2NyaXB0aW9uOiByb3cuZGVzY3JpcHRpb24sXG4gICAgICB1c2VySWQ6IHJvdy51c2VyX2lkLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShyb3cuY3JlYXRlZF9hdCksXG4gICAgICB1cGRhdGVkQXQ6IHJvdy51cGRhdGVkX2F0ID8gbmV3IERhdGUocm93LnVwZGF0ZWRfYXQpIDogdW5kZWZpbmVkXG4gICAgfVxuICB9XG4gIFxuICBwcml2YXRlIHN0YXRpYyBjYW1lbFRvU25ha2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvW0EtWl0vZywgbGV0dGVyID0+IGBfJHtsZXR0ZXIudG9Mb3dlckNhc2UoKX1gKVxuICB9XG59XG5cbi8vIOS8mOaDoOeggeebuOWFs+aTjeS9nFxuZXhwb3J0IGNsYXNzIERpc2NvdW50U2VydmljZSB7XG4gIC8vIOWIm+W7uuS8mOaDoOeggVxuICBzdGF0aWMgYXN5bmMgY3JlYXRlRGlzY291bnQoZGlzY291bnREYXRhOiBPbWl0PERpc2NvdW50LCAnZGlzY291bnRJZCcgfCAnY3JlYXRlZEF0JyB8ICd1c2FnZUNvdW50Jz4pOiBQcm9taXNlPERpc2NvdW50PiB7XG4gICAgY29uc3QgZGlzY291bnRJZCA9IGdlbmVyYXRlSWQoJ2Rpc2NvdW50XycpXG4gICAgY29uc3QgY3JlYXRlZEF0ID0gbmV3IERhdGUoKVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgYElOU0VSVCBJTlRPIGRpc2NvdW50cyAoZGlzY291bnRfaWQsIGNvZGUsIGJhbGFuY2UsIGlzX2Z1bGxfZGlzY291bnQsIHN0YXR1cywgZGVzY3JpcHRpb24sIHVzYWdlX2NvdW50LCBtYXhfdXNhZ2UsIG1pbl9hbW91bnQsIGNyZWF0ZWRfYXQpXG4gICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCAkNywgJDgsICQ5LCAkMTApXG4gICAgICAgUkVUVVJOSU5HICpgLFxuICAgICAgW2Rpc2NvdW50SWQsIGRpc2NvdW50RGF0YS5jb2RlLCBkaXNjb3VudERhdGEuYmFsYW5jZSwgZGlzY291bnREYXRhLmlzRnVsbERpc2NvdW50LFxuICAgICAgIGRpc2NvdW50RGF0YS5zdGF0dXMsIGRpc2NvdW50RGF0YS5kZXNjcmlwdGlvbiwgMCwgZGlzY291bnREYXRhLm1heFVzYWdlLCBkaXNjb3VudERhdGEubWluQW1vdW50LCBjcmVhdGVkQXRdXG4gICAgKVxuICAgIFxuICAgIHJldHVybiB0aGlzLm1hcFJvd1RvRGlzY291bnQocmVzdWx0LnJvd3NbMF0pXG4gIH1cbiAgXG4gIC8vIOagueaNruS7o+eggeiOt+WPluS8mOaDoOeggVxuICBzdGF0aWMgYXN5bmMgZ2V0RGlzY291bnRCeUNvZGUoY29kZTogc3RyaW5nKTogUHJvbWlzZTxEaXNjb3VudCB8IG51bGw+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeSgnU0VMRUNUICogRlJPTSBkaXNjb3VudHMgV0hFUkUgY29kZSA9ICQxJywgW2NvZGVdKVxuICAgIHJldHVybiByZXN1bHQucm93cy5sZW5ndGggPiAwID8gdGhpcy5tYXBSb3dUb0Rpc2NvdW50KHJlc3VsdC5yb3dzWzBdKSA6IG51bGxcbiAgfVxuICBcbiAgLy8g6aqM6K+B5LyY5oOg56CBXG4gIHN0YXRpYyBhc3luYyB2YWxpZGF0ZURpc2NvdW50KGNvZGU6IHN0cmluZywgb3JkZXJBbW91bnQ6IG51bWJlcik6IFByb21pc2U8eyB2YWxpZDogYm9vbGVhbjsgZGlzY291bnQ/OiBEaXNjb3VudDsgbWVzc2FnZT86IHN0cmluZyB9PiB7XG4gICAgY29uc3QgZGlzY291bnQgPSBhd2FpdCB0aGlzLmdldERpc2NvdW50QnlDb2RlKGNvZGUpXG4gICAgXG4gICAgaWYgKCFkaXNjb3VudCkge1xuICAgICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCBtZXNzYWdlOiAn5LyY5oOg56CB5LiN5a2Y5ZyoJyB9XG4gICAgfVxuICAgIFxuICAgIGlmIChkaXNjb3VudC5zdGF0dXMgIT09ICdhY3RpdmUnKSB7XG4gICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIG1lc3NhZ2U6ICfkvJjmg6DnoIHlt7LlpLHmlYgnIH1cbiAgICB9XG4gICAgXG4gICAgaWYgKGRpc2NvdW50Lm1heFVzYWdlICYmIGRpc2NvdW50LnVzYWdlQ291bnQgPj0gZGlzY291bnQubWF4VXNhZ2UpIHtcbiAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgbWVzc2FnZTogJ+S8mOaDoOeggeS9v+eUqOasoeaVsOW3sui+vuS4iumZkCcgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoZGlzY291bnQubWluQW1vdW50ICYmIG9yZGVyQW1vdW50IDwgZGlzY291bnQubWluQW1vdW50KSB7XG4gICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIG1lc3NhZ2U6IGDorqLljZXph5Hpop3pnIDmu6Eke2Rpc2NvdW50Lm1pbkFtb3VudH3lhYNgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGRpc2NvdW50IH1cbiAgfVxuICBcbiAgLy8g5L2/55So5LyY5oOg56CBXG4gIHN0YXRpYyBhc3luYyB1c2VEaXNjb3VudChkaXNjb3VudElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBxdWVyeShcbiAgICAgICdVUERBVEUgZGlzY291bnRzIFNFVCB1c2FnZV9jb3VudCA9IHVzYWdlX2NvdW50ICsgMSBXSEVSRSBkaXNjb3VudF9pZCA9ICQxJyxcbiAgICAgIFtkaXNjb3VudElkXVxuICAgIClcbiAgfVxuICBcbiAgLy8g6I635Y+W5omA5pyJ5LyY5oOg56CBXG4gIHN0YXRpYyBhc3luYyBnZXRBbGxEaXNjb3VudHMobGltaXQgPSA1MCk6IFByb21pc2U8RGlzY291bnRbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gZGlzY291bnRzIE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQyBMSU1JVCAkMScsXG4gICAgICBbbGltaXRdXG4gICAgKVxuICAgIHJldHVybiByZXN1bHQucm93cy5tYXAocm93ID0+IHRoaXMubWFwUm93VG9EaXNjb3VudChyb3cpKVxuICB9XG4gIFxuICBwcml2YXRlIHN0YXRpYyBtYXBSb3dUb0Rpc2NvdW50KHJvdzogYW55KTogRGlzY291bnQge1xuICAgIHJldHVybiB7XG4gICAgICBkaXNjb3VudElkOiByb3cuZGlzY291bnRfaWQsXG4gICAgICBjb2RlOiByb3cuY29kZSxcbiAgICAgIGJhbGFuY2U6IHBhcnNlRmxvYXQocm93LmJhbGFuY2UpLFxuICAgICAgaXNGdWxsRGlzY291bnQ6IHJvdy5pc19mdWxsX2Rpc2NvdW50LFxuICAgICAgc3RhdHVzOiByb3cuc3RhdHVzLFxuICAgICAgZGVzY3JpcHRpb246IHJvdy5kZXNjcmlwdGlvbixcbiAgICAgIHVzYWdlQ291bnQ6IHJvdy51c2FnZV9jb3VudCxcbiAgICAgIG1heFVzYWdlOiByb3cubWF4X3VzYWdlLFxuICAgICAgbWluQW1vdW50OiByb3cubWluX2Ftb3VudCA/IHBhcnNlRmxvYXQocm93Lm1pbl9hbW91bnQpIDogdW5kZWZpbmVkLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShyb3cuY3JlYXRlZF9hdClcbiAgICB9XG4gIH1cbn1cblxuLy8g5pSv5LuY6K6w5b2V55u45YWz5pON5L2cXG5leHBvcnQgY2xhc3MgUGF5bWVudFJlY29yZFNlcnZpY2Uge1xuICAvLyDliJvlu7rmlK/ku5jorrDlvZVcbiAgc3RhdGljIGFzeW5jIGNyZWF0ZVBheW1lbnRSZWNvcmQocmVjb3JkRGF0YTogT21pdDxQYXltZW50UmVjb3JkLCAncmVjb3JkSWQnIHwgJ3BhaWRBdCc+KTogUHJvbWlzZTxQYXltZW50UmVjb3JkPiB7XG4gICAgY29uc3QgcmVjb3JkSWQgPSBnZW5lcmF0ZUlkKCdwYXltZW50XycpXG4gICAgY29uc3QgcGFpZEF0ID0gbmV3IERhdGUoKVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgYElOU0VSVCBJTlRPIHBheW1lbnRfcmVjb3JkcyAocmVjb3JkX2lkLCBwYXltZW50X2lkLCBvcmRlcl9pZCwgYW1vdW50LCBwYWlkX2Ftb3VudCwgZGlzY291bnRfYW1vdW50LCBwYXltZW50X21ldGhvZCwgdXNlcl9pZCwgZGlzY291bnRfaWQsIGRpc2NvdW50X2NvZGUsIHBhaWRfYXQsIG9yZGVyX2Rlc2NyaXB0aW9uKVxuICAgICAgIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcsICQ4LCAkOSwgJDEwLCAkMTEsICQxMilcbiAgICAgICBSRVRVUk5JTkcgKmAsXG4gICAgICBbcmVjb3JkSWQsIHJlY29yZERhdGEucGF5bWVudElkLCByZWNvcmREYXRhLm9yZGVySWQsIHJlY29yZERhdGEuYW1vdW50LCByZWNvcmREYXRhLnBhaWRBbW91bnQsXG4gICAgICAgcmVjb3JkRGF0YS5kaXNjb3VudEFtb3VudCwgcmVjb3JkRGF0YS5wYXltZW50TWV0aG9kLCByZWNvcmREYXRhLnVzZXJJZCwgcmVjb3JkRGF0YS5kaXNjb3VudElkLFxuICAgICAgIHJlY29yZERhdGEuZGlzY291bnRDb2RlLCBwYWlkQXQsIHJlY29yZERhdGEub3JkZXJEZXNjcmlwdGlvbl1cbiAgICApXG4gICAgXG4gICAgcmV0dXJuIHRoaXMubWFwUm93VG9QYXltZW50UmVjb3JkKHJlc3VsdC5yb3dzWzBdKVxuICB9XG4gIFxuICAvLyDojrflj5borqLljZXnmoTmlK/ku5jorrDlvZVcbiAgc3RhdGljIGFzeW5jIGdldFBheW1lbnRSZWNvcmRzQnlPcmRlcihvcmRlcklkOiBzdHJpbmcpOiBQcm9taXNlPFBheW1lbnRSZWNvcmRbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gcGF5bWVudF9yZWNvcmRzIFdIRVJFIG9yZGVyX2lkID0gJDEgT1JERVIgQlkgcGFpZF9hdCBERVNDJyxcbiAgICAgIFtvcmRlcklkXVxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0LnJvd3MubWFwKHJvdyA9PiB0aGlzLm1hcFJvd1RvUGF5bWVudFJlY29yZChyb3cpKVxuICB9XG4gIFxuICAvLyDojrflj5bnlKjmiLfnmoTmlK/ku5jorrDlvZVcbiAgc3RhdGljIGFzeW5jIGdldFVzZXJQYXltZW50UmVjb3Jkcyh1c2VySWQ6IHN0cmluZywgbGltaXQgPSAyMCk6IFByb21pc2U8UGF5bWVudFJlY29yZFtdPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBwYXltZW50X3JlY29yZHMgV0hFUkUgdXNlcl9pZCA9ICQxIE9SREVSIEJZIHBhaWRfYXQgREVTQyBMSU1JVCAkMicsXG4gICAgICBbdXNlcklkLCBsaW1pdF1cbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLm1hcChyb3cgPT4gdGhpcy5tYXBSb3dUb1BheW1lbnRSZWNvcmQocm93KSlcbiAgfVxuICBcbiAgLy8g6I635Y+W5omA5pyJ5pSv5LuY6K6w5b2VXG4gIHN0YXRpYyBhc3luYyBnZXRBbGxQYXltZW50UmVjb3JkcyhsaW1pdCA9IDEwMCk6IFByb21pc2U8UGF5bWVudFJlY29yZFtdPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBwYXltZW50X3JlY29yZHMgT1JERVIgQlkgcGFpZF9hdCBERVNDIExJTUlUICQxJyxcbiAgICAgIFtsaW1pdF1cbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLm1hcChyb3cgPT4gdGhpcy5tYXBSb3dUb1BheW1lbnRSZWNvcmQocm93KSlcbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgbWFwUm93VG9QYXltZW50UmVjb3JkKHJvdzogYW55KTogUGF5bWVudFJlY29yZCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlY29yZElkOiByb3cucmVjb3JkX2lkLFxuICAgICAgcGF5bWVudElkOiByb3cucGF5bWVudF9pZCxcbiAgICAgIG9yZGVySWQ6IHJvdy5vcmRlcl9pZCxcbiAgICAgIGFtb3VudDogcGFyc2VGbG9hdChyb3cuYW1vdW50KSxcbiAgICAgIHBhaWRBbW91bnQ6IHBhcnNlRmxvYXQocm93LnBhaWRfYW1vdW50KSxcbiAgICAgIGRpc2NvdW50QW1vdW50OiBwYXJzZUZsb2F0KHJvdy5kaXNjb3VudF9hbW91bnQpLFxuICAgICAgcGF5bWVudE1ldGhvZDogcm93LnBheW1lbnRfbWV0aG9kLFxuICAgICAgdXNlcklkOiByb3cudXNlcl9pZCxcbiAgICAgIGRpc2NvdW50SWQ6IHJvdy5kaXNjb3VudF9pZCxcbiAgICAgIGRpc2NvdW50Q29kZTogcm93LmRpc2NvdW50X2NvZGUsXG4gICAgICBwYWlkQXQ6IG5ldyBEYXRlKHJvdy5wYWlkX2F0KSxcbiAgICAgIG9yZGVyRGVzY3JpcHRpb246IHJvdy5vcmRlcl9kZXNjcmlwdGlvblxuICAgIH1cbiAgfVxufVxuXG4vLyDnu5/orqHnm7jlhbPmk43kvZxcbmV4cG9ydCBjbGFzcyBTdGF0c1NlcnZpY2Uge1xuICAvLyDojrflj5bnu5/orqHmlbDmja5cbiAgc3RhdGljIGFzeW5jIGdldFN0YXRzKCk6IFByb21pc2U8e1xuICAgIHRvdGFsT3JkZXJzOiBudW1iZXJcbiAgICB0b3RhbFJldmVudWU6IG51bWJlclxuICAgIHRvdGFsRGlzY291bnRzOiBudW1iZXJcbiAgICB0b3RhbFBheW1lbnRzOiBudW1iZXJcbiAgfT4ge1xuICAgIGNvbnN0IFtvcmRlcnNSZXN1bHQsIHJldmVudWVSZXN1bHQsIGRpc2NvdW50c1Jlc3VsdCwgcGF5bWVudHNSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgcXVlcnkoJ1NFTEVDVCBDT1VOVCgqKSBhcyBjb3VudCBGUk9NIG9yZGVycycpLFxuICAgICAgcXVlcnkoJ1NFTEVDVCBTVU0ocGFpZF9hbW91bnQpIGFzIHRvdGFsIEZST00gcGF5bWVudF9yZWNvcmRzJyksXG4gICAgICBxdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gZGlzY291bnRzJyksXG4gICAgICBxdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gcGF5bWVudF9yZWNvcmRzJylcbiAgICBdKVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbE9yZGVyczogcGFyc2VJbnQob3JkZXJzUmVzdWx0LnJvd3NbMF0uY291bnQpLFxuICAgICAgdG90YWxSZXZlbnVlOiBwYXJzZUZsb2F0KHJldmVudWVSZXN1bHQucm93c1swXS50b3RhbCB8fCAnMCcpLFxuICAgICAgdG90YWxEaXNjb3VudHM6IHBhcnNlSW50KGRpc2NvdW50c1Jlc3VsdC5yb3dzWzBdLmNvdW50KSxcbiAgICAgIHRvdGFsUGF5bWVudHM6IHBhcnNlSW50KHBheW1lbnRzUmVzdWx0LnJvd3NbMF0uY291bnQpXG4gICAgfVxuICB9XG59XG5cbi8vIOeKtuaAgee/u+ivkVxuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZVN0YXR1cyhzdGF0dXM6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHN0YXR1c01hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICBwZW5kaW5nOiAn5b6F5pSv5LuYJyxcbiAgICBwYWlkOiAn5bey5pSv5LuYJyxcbiAgICBjYW5jZWxsZWQ6ICflt7Llj5bmtognLFxuICAgIGFjdGl2ZTogJ+acieaViCcsXG4gICAgdXNlZDogJ+W3suS9v+eUqCcsXG4gICAgZXhwaXJlZDogJ+W3sui/h+acnydcbiAgfVxuICByZXR1cm4gc3RhdHVzTWFwW3N0YXR1c10gfHwgc3RhdHVzXG59Il0sIm5hbWVzIjpbInF1ZXJ5IiwiZ2VuZXJhdGVJZCIsIk9yZGVyU2VydmljZSIsImNyZWF0ZU9yZGVyIiwib3JkZXJEYXRhIiwib3JkZXJJZCIsImNyZWF0ZWRBdCIsIkRhdGUiLCJyZXN1bHQiLCJwYXltZW50SWQiLCJhbW91bnQiLCJiYWxhbmNlIiwic3RhdHVzIiwicGF5bWVudE1ldGhvZCIsImRlc2NyaXB0aW9uIiwidXNlcklkIiwibWFwUm93VG9PcmRlciIsInJvd3MiLCJnZXRPcmRlciIsImxlbmd0aCIsInVwZGF0ZU9yZGVyIiwidXBkYXRlcyIsInVwZGF0ZWRBdCIsInNldENsYXVzZSIsInZhbHVlcyIsInBhcmFtSW5kZXgiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImtleSIsInZhbHVlIiwidW5kZWZpbmVkIiwiZGJLZXkiLCJjYW1lbFRvU25ha2UiLCJwdXNoIiwiam9pbiIsImdldFVzZXJPcmRlcnMiLCJsaW1pdCIsIm1hcCIsInJvdyIsImdldEFsbE9yZGVycyIsIm9yZGVyX2lkIiwicGF5bWVudF9pZCIsInBhcnNlRmxvYXQiLCJwYXltZW50X21ldGhvZCIsInVzZXJfaWQiLCJjcmVhdGVkX2F0IiwidXBkYXRlZF9hdCIsInN0ciIsInJlcGxhY2UiLCJsZXR0ZXIiLCJ0b0xvd2VyQ2FzZSIsIkRpc2NvdW50U2VydmljZSIsImNyZWF0ZURpc2NvdW50IiwiZGlzY291bnREYXRhIiwiZGlzY291bnRJZCIsImNvZGUiLCJpc0Z1bGxEaXNjb3VudCIsIm1heFVzYWdlIiwibWluQW1vdW50IiwibWFwUm93VG9EaXNjb3VudCIsImdldERpc2NvdW50QnlDb2RlIiwidmFsaWRhdGVEaXNjb3VudCIsIm9yZGVyQW1vdW50IiwiZGlzY291bnQiLCJ2YWxpZCIsIm1lc3NhZ2UiLCJ1c2FnZUNvdW50IiwidXNlRGlzY291bnQiLCJnZXRBbGxEaXNjb3VudHMiLCJkaXNjb3VudF9pZCIsImlzX2Z1bGxfZGlzY291bnQiLCJ1c2FnZV9jb3VudCIsIm1heF91c2FnZSIsIm1pbl9hbW91bnQiLCJQYXltZW50UmVjb3JkU2VydmljZSIsImNyZWF0ZVBheW1lbnRSZWNvcmQiLCJyZWNvcmREYXRhIiwicmVjb3JkSWQiLCJwYWlkQXQiLCJwYWlkQW1vdW50IiwiZGlzY291bnRBbW91bnQiLCJkaXNjb3VudENvZGUiLCJvcmRlckRlc2NyaXB0aW9uIiwibWFwUm93VG9QYXltZW50UmVjb3JkIiwiZ2V0UGF5bWVudFJlY29yZHNCeU9yZGVyIiwiZ2V0VXNlclBheW1lbnRSZWNvcmRzIiwiZ2V0QWxsUGF5bWVudFJlY29yZHMiLCJyZWNvcmRfaWQiLCJwYWlkX2Ftb3VudCIsImRpc2NvdW50X2Ftb3VudCIsImRpc2NvdW50X2NvZGUiLCJwYWlkX2F0Iiwib3JkZXJfZGVzY3JpcHRpb24iLCJTdGF0c1NlcnZpY2UiLCJnZXRTdGF0cyIsIm9yZGVyc1Jlc3VsdCIsInJldmVudWVSZXN1bHQiLCJkaXNjb3VudHNSZXN1bHQiLCJwYXltZW50c1Jlc3VsdCIsIlByb21pc2UiLCJhbGwiLCJ0b3RhbE9yZGVycyIsInBhcnNlSW50IiwiY291bnQiLCJ0b3RhbFJldmVudWUiLCJ0b3RhbCIsInRvdGFsRGlzY291bnRzIiwidG90YWxQYXltZW50cyIsInRyYW5zbGF0ZVN0YXR1cyIsInN0YXR1c01hcCIsInBlbmRpbmciLCJwYWlkIiwiY2FuY2VsbGVkIiwiYWN0aXZlIiwidXNlZCIsImV4cGlyZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/storage.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstats%2Froute&page=%2Fapi%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cthinkpad%5CDesktop%5Cpay&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();